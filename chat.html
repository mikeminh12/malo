<!DOCTYPE html>
<html lang="en" class="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Malo Messenger</title>

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#3b82f6",
                        "bg-surface": "#f9fafb",
                        "bg-chat": "#ffffff",
                    },
                    fontFamily: {
                        sans: ["Plus Jakarta Sans", "sans-serif"],
                    },
                },
            },
        };
    </script>

    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply font-sans antialiased text-slate-700;
            }
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #e2e8f0;
            border-radius: 10px;
        }

        .msg {
            @apply p-3.5 rounded-2xl max-w-[75%] mb-3 text-[15px] font-medium leading-relaxed shadow-sm;
        }
        .msg.me {
            @apply bg-gradient-to-br from-blue-500 to-blue-600 text-white self-end rounded-br-none;
        }
        .msg.them {
            @apply bg-white text-slate-700 self-start rounded-bl-none border border-slate-100;
        }
    </style>
</head>

<body class="h-[100dvh] overflow-hidden bg-bg-surface">
    <div class="flex h-full w-full overflow-hidden">

        <!-- SIDEBAR -->
        <aside class="hidden md:flex w-20 lg:w-24 flex-col bg-bg-surface border-r border-slate-100">
            <div class="flex flex-col items-center justify-between h-full py-8">
                <div class="flex flex-col items-center gap-10">
                    <div
                        class="size-12 rounded-2xl bg-gradient-to-br from-blue-600 to-blue-500 flex items-center justify-center text-white shadow-lg">
                        <span class="material-symbols-outlined">chat_bubble</span>
                    </div>
                    <nav class="flex flex-col gap-6 w-full px-2">
                        <div id="navChat"
                            class="group relative flex justify-center p-3 rounded-xl bg-blue-50 text-blue-600 cursor-pointer transition-all">
                            <div class="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-blue-600 rounded-r-full">
                            </div>
                            <span class="material-symbols-outlined text-[26px]">chat</span>
                        </div>
                        <div id="navDiscover"
                            class="group flex justify-center p-3 rounded-xl text-slate-400 hover:text-blue-600 hover:bg-blue-50 cursor-pointer transition-all">
                            <span class="material-symbols-outlined text-[26px]">explore</span>
                        </div>
                    </nav>
                </div>
                <div id="navAvatar" class="size-10 rounded-2xl bg-slate-200 flex items-center justify-center font-bold">
                    ?
                </div>
            </div>
        </aside>

        <!-- MAIN LIST -->
        <main class="w-full md:w-80 lg:w-[420px] flex flex-col bg-bg-surface border-r border-slate-100">
            <div class="px-6 pt-6 pb-4">
                <h2 class="text-2xl font-extrabold text-slate-800">Malo Chat</h2>
            </div>

            <div id="mainList" class="flex-1 overflow-y-auto px-4 pb-6 custom-scrollbar"></div>
        </main>

        <!-- CHAT SECTION -->
        <!-- ❗ FIX CHÍNH Ở ĐÂY -->
        <section id="chatSection"
            class="fixed inset-0 md:static flex flex-col bg-bg-chat md:flex-1 h-full transition-transform md:translate-x-0 translate-x-full">

            <!-- HEADER -->
            <header class="shrink-0 h-16 md:h-24 flex items-center px-4 md:px-10 border-b border-slate-100 bg-white">
                <h3 id="chatTitle" class="text-lg font-bold">Chọn cuộc trò chuyện</h3>
            </header>

            <!-- PINNED -->
            <div id="pinnedMsg" class="hidden shrink-0 px-6 py-2 bg-yellow-50 border-b border-yellow-100">
                <p class="text-xs font-bold text-yellow-700">Pinned message</p>
            </div>

            <!-- MESSAGES -->
            <!-- ❗ flex-1 + pb-28 để không bị footer đè -->
            <div id="msgBox" class="flex-1 overflow-y-auto px-4 md:px-10 py-6 pb-28 flex flex-col custom-scrollbar">
            </div>

            <!-- TYPING -->
            <div id="typingIndicator" class="shrink-0 px-10 pb-2 text-xs text-slate-400 italic hidden">
                User is typing...
            </div>

            <!-- FOOTER / INPUT -->
            <!-- ❗ shrink-0 để không ảnh hưởng chiều cao -->
            <footer class="shrink-0 px-4 md:px-10 py-4 bg-white border-t border-slate-100">
                <div class="flex items-center gap-3 bg-slate-50 p-2 rounded-full border">
                    <button class="size-10 flex items-center justify-center text-slate-400 hover:text-blue-500">
                        <span class="material-symbols-outlined">mood</span>
                    </button>

                    <input id="txtMsg" type="text" placeholder="Nhập tin nhắn..."
                        class="flex-1 bg-transparent border-none focus:ring-0 px-2 py-2" />

                    <button id="btnSend"
                        class="size-10 bg-primary text-white rounded-full flex items-center justify-center shadow hover:scale-105 active:scale-95 transition">
                        <span class="material-symbols-outlined">send</span>
                    </button>
                </div>
            </footer>
        </section>
    </div>

    <script type="module" src="js/app.js"></script>
</body>

</html>